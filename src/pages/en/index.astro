---
// Astro Frontmatter
import Image from '../../components/Image.astro';
import Layout from '../../layouts/Layout.astro';
import KANAMI from '../../assets/img/kanami.webp';
import ERIKA from '../../assets/img/erika.webp';
import SHOTA from '../../assets/img/shota.webp';
import NIKOLAY from '../../assets/img/nikolay.webp';
import MURASHOV from '../../assets/img/murashov.webp';
import Hero1 from '../../assets/img/hero.webp';
import Hero2 from '../../assets/img/hero2.webp';
import Hero3 from '../../assets/img/hero3.webp';
import Hero4 from '../../assets/img/hero4.webp';
import Hero5 from '../../assets/img/hero5.webp';
import SHero1 from '../../assets/img/s-hero.webp';
import SHero2 from '../../assets/img/s-hero2.webp';
import SHero3 from '../../assets/img/s-hero3.webp';
import SHero4 from '../../assets/img/s-hero4.webp';
import SHero5 from '../../assets/img/s-hero5.webp';
import OSAKA2 from '../../assets/img/osaka_02.webp';
import Ballet from '../../assets/img/ballet-shoes.webp';
import Dancer from '../../assets/img/dancer1.webp';
import Dancer2 from '../../assets/img/dancer2.webp';
import Dancer3 from '../../assets/img/dancer3.webp';
import Dancer4 from '../../assets/img/dancer4.webp';
import Dancer5 from '../../assets/img/dancer5.webp';
import Dancer6 from '../../assets/img/dancer6.webp';
import C1 from '../../assets/img/c1.webp';
import C2 from '../../assets/img/c2.webp';
import C3 from '../../assets/img/c3.webp';
import C4 from '../../assets/img/c4.webp';
import C5 from '../../assets/img/c5.webp';
import C6 from '../../assets/img/c6.webp';
import C7 from '../../assets/img/c7.webp';
import Cirque from '../../assets/img/cirquedhiver.webp';
import Cirquebg from '../../assets/img/cirque-bg.webp';
import Circus from '../../assets/img/circus.webp';
import Circus2 from '../../assets/img/circus2.webp';
import Circus3 from '../../assets/img/circus3.webp';
import Circus4 from '../../assets/img/circus4.webp';
import Eiffel from '../../assets/img/eiffel.webp';
import SlideImage from '../../components/SlideImage.astro';

// Define cirqueImages array
const cirqueImages = [
  { src: Circus, alt: 'Circus' },
  { src: Circus2, alt: 'Circus 2' },
  { src: Circus3, alt: 'Circus 3' },
  { src: Circus4, alt: 'Circus 4' },
  { src: Cirque, alt: 'Cirque d\'hiver' },
  { src: Eiffel, alt: 'Eiffel-tower' },
];

// Preload hero images
const preloadImages = [
  { src: Hero1, type: 'image/webp' },
  { src: Hero2, type: 'image/webp' },
  { src: Hero3, type: 'image/webp' },
  { src: Hero4, type: 'image/webp' },
  { src: Hero5, type: 'image/webp' },
  { src: SHero1, type: 'image/webp' },
  { src: SHero2, type: 'image/webp' },
  { src: SHero3, type: 'image/webp' },
  { src: SHero4, type: 'image/webp' },
  { src: SHero5, type: 'image/webp' },
];

---

<!-- Preload hero images -->
{preloadImages.map((img) => (
  <link
    rel="preload"
    href={img.src.src}
    as="image"
    type={img.type}
    fetchpriority="high"
  />
))}

<!-- SlickのCSSをhead内で読み込む（またはここでもOK） -->
<link rel="stylesheet" href="/slick/slick.css" />
<link rel="stylesheet" href="/slick/slick-theme.css" />

<Layout title={import.meta.env.PUBLIC_TITLE}>
  <!-- Hero Section -->
  <div class="relative w-full h-[100dvh] min-h-[100dvh] overflow-hidden">
    <!-- Initial Image -->
    <div id="hero-slider" class="absolute top-0 left-0 w-full h-full z-0">
      <div class="slide active">
        <Image
          src={Hero1}
          alt="ERIKA"
          class="w-full h-full object-cover brightness-130 hidden md:block"
          loading="eager"
          decoding="async"
        />
        <Image
          src={SHero1}
          alt="ERIKA"
          class="w-full h-full object-cover brightness-130 md:hidden"
          loading="eager"
          decoding="async"
        />
      </div>
      <div class="slide">
        <Image
          src={Hero2}
          alt="KANAMI"
          class="w-full h-full object-cover brightness-130 hidden md:block"
          loading="lazy"
          decoding="async"
        />
        <Image
          src={SHero2}
          alt="KANAMI"
          class="w-full h-full object-cover brightness-130 md:hidden"
          loading="lazy"
          decoding="async"
        />
      </div>
      <div class="slide">
        <Image
          src={Hero3}
          alt="SHOTA"
          class="w-full h-full object-cover brightness-130 hidden md:block"
          loading="lazy"
          decoding="async"
        />
        <Image
          src={SHero3}
          alt="SHOTA"
          class="w-full h-full object-cover brightness-130 md:hidden"
          loading="lazy"
          decoding="async"
        />
      </div>
      <div class="slide">
        <Image
          src={Hero5}
          alt="Circus"
          class="w-full h-full object-cover brightness-130 hidden md:block"
          loading="lazy"
          decoding="async"
        />
        <Image
          src={SHero5}
          alt="Circus"
          class="w-full h-full object-cover brightness-130 md:hidden"
          loading="lazy"
          decoding="async"
        />
      </div>
      <div class="slide">
        <Image
          src={Hero4}
          alt="NIKOLAY"
          class="w-full h-full object-cover brightness-130 hidden md:block"
          loading="lazy"
          decoding="async"
        />
        <Image
          src={SHero4}
          alt="NIKOLAY"
          class="w-full h-full object-cover brightness-130 md:hidden"
          loading="lazy"
          decoding="async"
        />
      </div>
    </div>
    <!-- Expo Text Section - PC用（現状維持） -->
    <div class="absolute bottom-[15%] left-0 md:bottom-[10%] md:left-10 z-[100] expo-hero-text hidden md:block">
      <h1 class="expo-subheading font-notojp">
        The Firebird<br>
        ~Contemporary Spectacle with Ballet and Parisian Modern Circus~<br class="md:hidden" />
      </h1>
      <h2 class="expo-heading">EXPO 2025</h2>
      <p class="expo-subheading">Osaka–Kansai EXPO Performance</p>
      <p class="expo-subheading">August 31 (Sun) – September 2 (Tue), 2025</p>
      <p class="expo-subheading mt-4">Reservations open on July 12 at 12:00 PM</p>
    </div>
    <!-- スマホ用テキスト＆グラデーションをまとめてラップ -->
    <div class="absolute bottom-0 left-0 w-full h-full md:hidden">
      <!-- Expo Info Section - hero内下部グラデーション（スマホ用） -->
      <div class="absolute bottom-0 left-0 w-full z-[110]">
        <!-- テキストをグラデーション直前に左寄せで配置 -->
        <div class="w-full flex flex-col items-start mb-2 px-2">
          <h1 class="font-notojp">"The Firebird"</h1>
          <h1 class="font-notojp">~Contemporary Spectacle<br>with Ballet and Parisian Modern Circus~</h1>
        </div>
        <div class="w-full py-3 px-2 flex flex-row items-center justify-between" style="background:linear-gradient(to right,rgba(130,0,0,0.85) 0%,rgba(130,0,0,0.0) 100%); min-height: 15vh; max-height: 20vh;">
          <!-- 左：テキスト -->
          <div class="flex-1 text-left leading-tight">
            <h2 class="text-white text-xl font-bold mb-0 leading-tight">EXPO 2025</h2>
            <p class="text-white text-base mb-0 leading-tight">Osaka/Kansai EXPO Performance</p>
            <p class="text-white text-base leading-tight">August 31 (Sun) - September 2 (Tue), 2025</p>
            <p class="text-white text-xl font-bold leading-tight">Reservations open on July 12 at 12:00 PM</p>
          </div>
        </div>
      </div>
      <!-- OSAKAロゴをabsoluteで右下に配置 -->
      <div class="absolute bottom-[calc(15vh+4%)] right-2 z-[120]">
        <Image src={OSAKA2} alt="OSAKA EXPO 2025" class="w-40 h-auto" />
      </div>
    </div>

    <!-- Osaka Image - Desktop -->
    <div class="absolute bottom-[36%] right-8 z-[100] hidden md:block">
      <Image
        src={OSAKA2}
        alt="OSAKA EXPO 2025"
        class="w-80"
      />
    </div>
  </div>

  <!-- コンテンツを包むラッパー -->
  <div class="relative bg-black z-[10]">
    <section id="introduction"
      class="relative bg-cover bg-center bg-no-repeat text-white py-32 font-notojp w-full bg-black z-[20]">
        <!-- スポットライト背景 -->
  <div class="spotlight pointer-events-none"></div>
      <div class="flex flex-col w-full">
        <div class="w-full bg-black p-8 flex flex-col justify-center items-center mx-auto text-center story-text-container transition-colors duration-[2000ms]">
          <div class="letter-effect">
            <h2 class="text-lg md:text-2xl font-serif font-light tracking-wide mb-1 slide-in-right" style="color:#bfae9e">INTRODUCTION</h2>
            <div class="w-full border-b mb-6 underline-animate slide-in-right" style="border-color:#bfae9e; transform:scaleX(0); transform-origin:left; transition:transform 0.7s cubic-bezier(0.4,0,0.2,1);"></div>
            <p class="!text-white text-sm md:text-base leading-relaxed mb-4 story-text font-serif font-light" data-delay="0.1">
              Inspired by the theme of Expo 2025 Osaka, "Designing Future Society for Our Lives."
            </p>
            <p class="!text-white text-sm md:text-base leading-relaxed mb-4 story-text" data-delay="0.15">
              From the "gateway to the future," we hope everyone can pursue their own way of life and reach their fullest potential, soaring on wings of dreams and inspiration.
            </p>
            <p class="!text-white text-sm md:text-base leading-relaxed mb-4 story-text" data-delay="0.2">
              Stravinsky's masterpiece <em>The Firebird</em> is reimagined through ballet and contemporary circus.
            </p>
            <p class="!text-white text-sm md:text-base leading-relaxed mb-4 story-text" data-delay="0.25">
              The story unfolds between fantasy and reality, driven by the wish to restore a peaceful and free world.
            </p>
            <p class="!text-white text-sm md:text-base leading-relaxed mb-4 story-text" data-delay="0.3">
              The moment the audience steps through the door, the performance begins.
            </p>
            <p class="!text-white text-sm md:text-base leading-relaxed mb-4 story-text" data-delay="0.35">
              Through Expo 2025 Osaka, we hope this work will become an opportunity to share dreams and inspiration with people all over the world.
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- New Section: Cirque -->
    <section
    id="cirque"
    class="w-full flex flex-col items-center text-xl py-12 md:py-24 relative z-[20] bg-cover bg-center min-h-[80vh]"
    style={{
      backgroundImage: `linear-gradient(to top, rgba(0, 0, 0, 0.65), rgba(0, 0, 0, 0.2)), url('${Cirquebg.src}')`,
      backgroundColor: '#0a0000'
    }}
  >
      <div class="flex flex-col md:flex-row items-center justify-center gap-2 md:gap-8 w-full max-w-5xl px-4">
        <div class="flex flex-col justify-center items-start story-text-container text-left md:p-12 transition-colors duration-[2000ms] w-full order-1 md:order-2">
          <div class="letter-effect">
            <h2 class="text-lg md:text-2xl font-serif font-light tracking-wide mb-1 slide-in-right whitespace-nowrap">Ballet × Paris Contemporary Circus</h2>
            <div class="w-full border-b mb-6 underline-animate slide-in-right" style="transform:scaleX(0); transform-origin:left; transition:transform 0.7s cubic-bezier(0.4,0,0.2,1);"></div>
            <p class="!text-white text-base leading-relaxed mb-4 story-text" data-delay="0.1">
              Cirque d'Hiver, the renowned contemporary circus troupe from Paris, joins forces with ballet to create a breathtaking fusion of art forms.            </p>
          </div>
        </div>
      </div>
      <!-- Lower: Custom Horizontal Slider -->
      <div class="overflow-hidden relative w-full">
        <div class="flex animate-slide-track" style="width: calc(320px * 12);">
          {cirqueImages.concat(cirqueImages).map((img) => (
            <div class="h-96 w-80 flex-shrink-0 flex-grow-0 flex items-center justify-center">
              <img
                src={typeof img.src === 'string' ? img.src : img.src.src}
                alt={img.alt}
                class="h-96 w-full object-cover"
              />
            </div>
          ))}
        </div>
      </div>
        {/* スライダー直下に右寄せテキスト追加 */}
        <div class="w-full flex justify-end mt-12">
          <a href="https://www.cirquedhiver.com/" target="_blank" rel="noopener noreferrer" class="text-white font-serif drop-shadow-lg pr-8 md:pr-16 underline underline-offset-4 hover:text-[#bfae9e] hover:underline hover:scale-105 transition-all duration-200 cursor-pointer">
            About Cirque d'hiver Bouglione
          </a>
        </div>
    </section>

    <section id="cast" class="bg-black py-20 px-6">
      <div class="max-w-6xl mx-auto text-center">
        <div class="letter-effect">
          <h2 class="text-lg md:text-2xl font-serif font-light tracking-wide mb-6 fade-in-text text-[#bfae9e]">CAST & STAFF</h2>
        </div>
      </div>

      <!-- Kanami only, centered -->
      <div class="flex justify-center mb-8">
        <a href="/en/cast#en-kanami" class="cast-item">
          <Image
            src={KANAMI}
            alt={import.meta.env.PUBLIC_TITLE}
            class="w-52 h-52 md:w-52 md:h-52 rounded-full object-cover grayscale-cast hover:grayscale-0 transition-all duration-300"
          />
          <p class="text-base md:text-lg text-white font-serif text-center mt-2">Planning, Production, and Starring<br>KANAMI</p>
        </a>
      </div>
      <!-- Other 5 cast in grid -->
      <div class="cast-grid grid grid-cols-2 md:grid-cols-5 gap-2 md:gap-x-2 md:gap-y-4 px-2 text-white font-serif max-w-6xl mx-auto">
        <a href="/en/cast#en-shota" class="cast-item transform hover:scale-105 transition-transform duration-300">
          <Image
            src={SHOTA}
            alt={import.meta.env.PUBLIC_TITLE}
            class="w-32 h-32 md:w-48 md:h-48 rounded-full object-cover grayscale-cast hover:grayscale-0 transition-all duration-300"
          />
          <p class="mt-4 text-base md:text-lg">Shota Onodera</p>
        </a>
        <a href="/cast#erika" class="cast-item transform hover:scale-105 transition-transform duration-300">
          <Image
            src={ERIKA}
            alt={import.meta.env.PUBLIC_TITLE}
            class="w-32 h-32 md:w-48 md:h-48 rounded-full object-cover grayscale-cast hover:grayscale-0 transition-all duration-300"
          />
          <p class="mt-4 text-base md:text-lg">Erica</p>
        </a>
        <a href="/en/cast#en-nikolay" class="cast-item transform hover:scale-105 transition-transform duration-300">
          <Image
            src={NIKOLAY}
            alt={import.meta.env.PUBLIC_TITLE}
            class="w-32 h-32 md:w-48 md:h-48 rounded-full object-cover grayscale-cast hover:grayscale-0 transition-all duration-300"
          />
          <p class="mt-4 text-base md:text-lg">Nikolay Viyuzhanin</p>
        </a>
        <a href="/en/cast#en-fedor" class="cast-item transform hover:scale-105 transition-transform duration-300">
          <Image
            src={MURASHOV}
            alt={import.meta.env.PUBLIC_TITLE}
            class="w-32 h-32 md:w-48 md:h-48 rounded-full object-cover grayscale-cast hover:grayscale-0 transition-all duration-300"
          />
          <p class="mt-4 text-base md:text-lg">Fedor Murashov</p>
        </a>
        <a href="/en/cast#en-joseph" class="cast-item transform hover:scale-105 transition-transform duration-300">
          <Image
            src={C7}
            alt={import.meta.env.PUBLIC_TITLE}
            class="w-32 h-32 md:w-48 md:h-48 rounded-full object-cover grayscale-cast hover:grayscale-0 transition-all duration-300"
          />
          <p class="mt-4 text-base md:text-lg whitespace-nowrap">JOSEPH BOUGLIONE</p>
        </a>
      </div>

      <!-- New section for smaller circular images -->
      <div class="mt-12 max-w-6xl mx-auto">
        <!-- Top row: 6 images, left space (centered on mobile) -->
        <!-- モバイル用ラベル -->
        <div class="md:hidden flex flex-col items-center mb-2">
          <span class="text-white text-lg font-serif">Ballet Dancers</span>
          <span class="text-white text-sm">The Princesses</span>
        </div>
        <div class="flex items-center md:mt-8 justify-center">
          <!-- PC用ラベル -->
          <div class="w-48 flex-shrink-0 flex-col items-end justify-center pr-4 hidden md:flex">
            <div class="flex flex-col items-end">
              <span class="text-white text-lg md:text-xl font-serif whitespace-nowrap">Ballet Dancers</span>
              <span class="text-white text-sm mt-1">The Princesses</span>
            </div>
          </div>
          <div class="grid grid-cols-3 md:grid-cols-6 gap-3 md:gap-2 flex-grow justify-end md:mx-0 mx-auto">
            <div class="flex flex-col items-center">
              <Image
                src={Dancer2}
                alt="Shota small"
                class="w-16 h-16 md:w-32 md:h-32 rounded-full object-cover transition-all duration-300"
              />
            </div>
            <div class="flex flex-col items-center">
              <Image
                src={Dancer3}
                alt="Nikolay small"
                class="w-16 h-16 md:w-32 md:h-32 rounded-full object-cover transition-all duration-300"
              />
            </div>
            <div class="flex flex-col items-center">
              <Image
                src={Dancer}
                alt="Erika small"
                class="w-16 h-16 md:w-32 md:h-32 rounded-full object-cover transition-all duration-300"
              />
            </div>
            <div class="flex flex-col items-center">
              <Image
                src={Dancer4}
                alt="Fedor small"
                class="w-16 h-16 md:w-32 md:h-32 rounded-full object-cover transition-all duration-300"
              />
            </div>
            <div class="flex flex-col items-center">
              <Image
                src={Dancer6}
                alt="Member 6"
                class="w-16 h-16 md:w-32 md:h-32 rounded-full object-cover transition-all duration-300"
              />
            </div>
            <div class="flex flex-col items-center">
              <Image
                src={Dancer5}
                alt="Member 5"
                class="w-16 h-16 md:w-32 md:h-32 rounded-full object-cover transition-all duration-300"
              />
            </div>
          </div>
        </div>
        <!-- Bottom row: 6images, label on left (label above on mobile) -->
        <!-- モバイル用ラベル -->
        <div class="md:hidden flex flex-col items-center mb-2 mt-8">
          <span class="text-white text-sm font-serif">The artists of Joseph BOUGLIONE artistic director of cirque d’hiver de Paris</span>
          <span class="text-white text-sm">Minions of the Demon</span>
        </div>
        <div class="flex items-center md:mt-8 justify-center">
          <!-- PC用ラベル -->
          <div class="w-48 flex-shrink-0 flex-col items-end justify-center pr-4 hidden md:flex">
            <div class="flex flex-col items-end">
              <span class="text-white text-sm font-serif">The artists of Joseph BOUGLIONE artistic director of cirque d’hiver de Paris</span>
              <span class="text-white text-sm mt-1">Minions of the Demon</span>
            </div>
          </div>
          <div class="grid grid-cols-3 md:grid-cols-6 gap-3 md:gap-4 flex-grow justify-center mx-auto">
            <div class="flex flex-col items-center">
              <Image
                src={C4}
                alt="Member 10"
                class="w-16 h-16 md:w-32 md:h-32 rounded-full object-cover transition-all duration-300"
              />
            </div>
            <div class="flex flex-col items-center">
              <Image
                src={C5}
                alt="Member 11"
                class="w-16 h-16 md:w-32 md:h-32 rounded-full object-cover transition-all duration-300"
              />
            </div>
            <div class="flex flex-col items-center">
              <Image
                src={C6}
                alt="Member 12"
                class="w-16 h-16 md:w-32 md:h-32 rounded-full object-cover transition-all duration-300"
              />
            </div>
            <div class="flex flex-col items-center">
              <Image
                src={C2}
                alt="Member 8"
                class="w-16 h-16 md:w-32 md:h-32 rounded-full object-cover transition-all duration-300"
              />
            </div>
            <div class="flex flex-col items-center">
              <Image
                src={C3}
                alt="Member 9"
                class="w-16 h-16 md:w-32 md:h-32 rounded-full object-cover transition-all duration-300"
              />
            </div>
            <div class="flex flex-col items-center">
              <Image
                src={C1}
                alt="Member 7"
                class="w-16 h-16 md:w-32 md:h-32 rounded-full object-cover transition-all duration-300"
              />
            </div>
          </div>
        </div>
      </div>

      <!-- View More Button -->
      <div class="flex flex-col items-center justify-center mt-12 gap-2">
        <p class="text-xs md:text-base font-serif text-white">
          Choreography: by Michel Fokine, in the editorial version by Fedor Murashov
        </p>
        <a href="/en/cast" class="view-more-btn group relative inline-flex items-center mt-4 gap-3 px-10 py-4 text-base text-white transition-all duration-500 ease-out hover:gap-6">
          <span class="relative z-10">View More Cast & Staff</span>
          <svg class="w-5 h-5 transition-transform duration-500 group-hover:translate-x-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M17 8l4 4m0 0l-4 4m4-4H3" />
          </svg>
        </a>
      </div>
      </div>
    </section>

    <section id="schedule" class="text-white bg-black relative z-[20]">
      <div class="container mx-auto px-4 text-center py-10 md:py-20">
        <p class="text-xs mb-2 tracking-widest font-serif text-[#bfae9e]">Performance Schedule & Ticket Information</p>
        <h2 class="text-lg md:text-2xl font-serif font-light tracking-wide mb-1 text-[#bfae9e]">SCHEDULE & TICKETS</h2>
        <p class="text-lg md:text-xl font-serif text-yellow-300 mb-6">Reservations Start July 12 at 12:00 PM</p>
        <div class="w-1/2 mx-auto border-b-2 border-[#bfae9e] mb-10 underline-animate" style="transform:scaleX(0); transform-origin:left; transition:transform 0.7s cubic-bezier(0.4,0,0.2,1);"></div>

        <div class="destinations_line" data-dly="800"></div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-8 mt-4 md:mt-12 max-w-4xl mx-auto">
          <div class="bg-black bg-opacity-50 backdrop-blur-sm rounded-lg p-6 ons_u" data-dly="600">
            <div class="text-base md:text-lg mb-2">August 31 (Sun)</div>
            <div class="text-red-400 text-sm mb-4">Opening Day: 2 Performances (60 min each)</div>
            <div class="space-y-2">
              <p class="text-sm">Part 1: 13:00～</p>
              <p class="text-sm">Part 2: 16:00～</p>
            </div>
          </div>
          <div class="bg-black bg-opacity-50 backdrop-blur-sm rounded-lg p-6 ons_u" data-dly="700">
            <div class="text-base md:text-lg mb-2">September 1 (Mon)</div>
            <div class="text-red-400 text-sm mb-4">Day 2: 2 Performances (60 min each)</div>
            <div class="space-y-2">
              <p class="text-sm">Part1 13:00～</p>
              <p class="text-sm">Part2 16:00～</p>
            </div>
          </div>
          <div class="bg-black bg-opacity-50 backdrop-blur-sm rounded-lg p-6 ons_u" data-dly="800">
            <div class="text-base md:text-lg mb-2">September 2 (Tue)</div>
            <div class="text-red-400 text-sm mb-4">Day 3: 2 Performances (60 min each)</div>
            <div class="space-y-2">
              <p class="text-sm">Part1 13:00～</p>
              <p class="text-sm">Part2 16:00～</p>
            </div>
          </div>
        </div>

        <div class="flex flex-col md:flex-row items-center justify-center gap-8 w-full max-w-4xl mx-auto mt-12">
          <!-- 左：地図 -->
          <div class="w-full md:w-1/2 flex flex-col items-center order-2 md:order-1">
            <!-- OSAKA2画像を地図の上に追加 -->
            <div class="w-full flex justify-center mb-4">
              <Image src={OSAKA2} alt="Osaka Expo Venue" class="w-full rounded-lg shadow-lg" />
            </div>
            <iframe
              src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d26257.807773339624!2d135.3484756791015!3d34.648995700000015!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x6000e900591538df%3A0x3dc550bb6d8fea62!2zMjAyNeW5tOaXpeacrOWbvemam-WNmuimp-S8miAo5aSn6Ziq44O76Zai6KW_5LiH5Y2aKQ!5e0!3m2!1sja!2sjp!4v1748817274085!5m2!1sja!2sjp"
              width="100%"
              height="300"
              style="border:0; border-radius: 1rem; min-width:250px; min-height:200px; max-width: 500px;"
              allowfullscreen=""
              loading="lazy"
              referrerpolicy="no-referrer-when-downgrade"
              title="大阪・関西万博の地図"
            ></iframe>
            <div class="flex items-center gap-2 text-white py-2 px-4 justify-center">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 flex-shrink-0" fill="white" viewBox="0 0 24 24">
                <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
              </svg>
              <span class="text-sm md:text-base">EXPO 2025 Osaka-Kansai Festival Station<br>(Indoor Event Space)</span>
            </div>
          </div>
          <!-- 右：テキスト -->
          <div class="w-full md:w-1/2 flex flex-col justify-center items-center text-left text-white h-full order-1 md:order-2 mb-8 md:mb-0" style="min-height:300px;">
            <div class="text-base bg-black bg-opacity-50 backdrop-blur-sm rounded-lg p-6 w-full">
              <p class="mb-4">This performance is free, with advance reservations required.
              However, admission to the Osaka/Kansai Expo venue requires an Expo admission ticket (paid).
              <p>Seat availability will be updated on our official SNS. For the latest information, please check Instagram.
              </p><br>
              <p class="text-lg md:text-xl font-serif font-bold text-red-700 mb-6">Reservations open on July 12 at 12:00 PM</p>
              <div class="flex justify-end">
                <a
                href={import.meta.env.PUBLIC_INSTAGRAM_URL}
                target="_blank"
                rel="noopener noreferrer"
                class="inline-block text-white hover:text-red-400 transition"
              >
                <i class="fab fa-instagram text-4xl mt-4"></i>
              </a>              
              </div>
              <p class="mb-4">Organizer: <a href="https://www.mirror-promotion.jp/" target="_blank" class="text-white hover:text-[#bfae9e] transition-colors underline hover:no-underline flex items-center gap-1">Mirror Promotion Inc.
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4 inline-block"><path d="M18 13v6a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
</a>
  fire-bird@mirror-promotion.jp
  <br>
            </div>
          </div>
        </div>
      </div>
    </div>
    </section>

     <!-- New Section: The Art of Celebrating -->
     <section class="flex flex-col items-stretch py-24 md:px-0 mx-auto gap-12 relative overflow-hidden bg-black">
      <!-- Background Image -->
      <div class="absolute inset-0 z-0">
        <div class="relative w-full h-full">
          <Image
            src={Ballet}
            alt="Ballet Background"
            class="absolute inset-0 w-full h-full object-cover opacity-30"
            style="object-position: center 10%;"
          />
          <div class="absolute inset-0 bg-black bg-opacity-40"></div>
        </div>
      </div>
      <!-- Content -->
      <div class="relative z-10">
        <!-- Heading Section -->
        <div class="w-full flex flex-col items-center text-center">
          <h2 class="text-2xl md:text-3xl font-serif tracking-widest fade-in-text mb-8" style="letter-spacing:0.08em;">Behind the Scenes</h2>
        </div>
        <!-- Content Section -->
        <div class="flex flex-col md:flex-row items-stretch gap-8">
          <!-- Right: Text Content -->
          <div class="w-full flex flex-col justify-center items-center story-text-container">
            <p class="text-sm mb-6 leading-relaxed text-center mx-auto">
              <span class="fade-in-text" style="--delay: 0.1s">The Osaka Expo of 1970—</span><br>
              <span class="fade-in-text" style="--delay: 0.2s">its theme: "Progress and Harmony for Mankind."</span><br>
              <span class="fade-in-text" style="--delay: 0.3s">My mother visited the venue many times with my grandmother, and  shared those memories with me.</span><br>
              <span class="fade-in-text" style="--delay: 0.4s">Even as a child, her words stayed deeply in my heart.</span><br>
              <span class="fade-in-text" style="--delay: 0.5s">I began to dream—<br>"One day, I want to be someone's inspiration."</span><br>
              <span class="fade-in-text" style="--delay: 0.6s">With a quiet hope for a future yet unseen,</span><br>
              <span class="fade-in-text" style="--delay: 0.7s">the vision I held back then is now becoming reality.</span><br><br>
              <span class="fade-in-text" style="--delay: 0.8s">KANAMI</span>
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- Video Section -->
    <section class="flex flex-col items-stretch py-4 md:px-0 relative bg-cover bg-center bg-no-repeat text-white"
      style="background: radial-gradient(circle at top right, rgba(130, 0, 0, 0.3), #000000 80%); background-color: #0a0000;">
      <!-- タイトルとテキスト -->
      <div class="w-full text-center mt-8">
        <h2 class="text-base md:text-xl tracking-widest fade-in-text mb-2" style="letter-spacing:0.08em;">Promotional Video</h2>
      </div>

      <div class="relative w-full flex justify-center items-center">
        <div class="w-full aspect-video max-w-2xl mx-auto">
          <iframe
            width="100%"
            height="100%"
            src="https://www.youtube.com/embed/k3Khzz_HRZU"
            title="YouTube video player"
            frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
            allowfullscreen
            class="w-full h-full"
          ></iframe>
        </div>
      </div>
    </section>


    <section id="story"
      class="relative bg-cover bg-center bg-no-repeat text-white py-16 md:py-24 font-notojp w-full"
      style="background: radial-gradient(circle at top left, rgba(130, 0, 0, 0.3), #000000 80%); background-color: #0a0000;">
      <div class="flex flex-col md:flex-row w-full">
        <!-- 左：画像（スマホ時は上） -->
        <div class="w-full md:w-1/2 h-56 md:h-auto">
          <SlideImage 
            src={Hero3}
            position="left"
            classNames="w-full h-full object-cover story-image"
            wrapperClass="w-full h-full"
          />
        </div>
        <!-- 右：テキスト（スマホ時は下） -->
        <div class="w-full md:w-1/2 text-left p-6 md:p-8 md:mr-10 flex flex-col justify-center story-text-container transition-colors duration-[2000ms]">
          <div class="letter-effect">
            <h2 class="text-lg md:text-2xl font-serif font-light tracking-wide mb-1 slide-in-right" style="color:#bfae9e">STORY</h2>
            <div class="w-full border-b mb-4 underline-animate slide-in-right" style="border-color:#bfae9e; transform:scaleX(0); transform-origin:left; transition:transform 0.7s cubic-bezier(0.4,0,0.2,1);"></div>
            <div class="space-y-2 md:space-y-3">
              <p class="text-sm md:text-base leading-relaxed story-text" data-delay="0.1">
                In a world shrouded in darkness,<br>a single ray of light pierces through—The Firebird.
              </p>
              <p class="text-sm md:text-base leading-relaxed story-text" data-delay="0.15">
                Once, the world lost its freedom and hope<br>due to the curse of the demon king Kashchey.
              </p>
              <p class="text-sm md:text-base leading-relaxed story-text" data-delay="0.2">
                Everything was silent, everything was bound, and no one was even allowed to dream.
              </p>
              <p class="text-sm md:text-base leading-relaxed story-text" data-delay="0.25">
                And then, in the midst of that darkness, appeared the Firebird—cloaked in golden feathers.
              </p>
              <p class="text-sm md:text-base leading-relaxed story-text" data-delay="0.35">
                The young prince Ivan happened to meet this mysterious bird and received one of its feathers.
              </p>
              <p class="text-sm md:text-base leading-relaxed story-text" data-delay="0.4">
                It was a sign to summon hope in the midst of despair—
              </p>
              <p class="text-sm md:text-base leading-relaxed story-text" data-delay="0.45">
                Beautiful princesses imprisoned in the demon king's castle.
              </p>
              <p class="text-sm md:text-base leading-relaxed story-text" data-delay="0.5">
                As the prince tried to save them, he was instead ensnared by the forces of darkness              
              </p>
              <p class="text-sm md:text-base leading-relaxed story-text" data-delay="0.55">
                But at that moment—
              </p>
              <p class="text-sm md:text-base leading-relaxed story-text" data-delay="0.6">
                The feather shines, the sky trembles, and the Firebird descends.
              </p>
              <p class="text-sm md:text-base leading-relaxed story-text" data-delay="0.65">
                With music, the Firebird brings back the "dance of life" to the world.
              </p>
            </div>
          </div>
        </div>
      </div>
    </section>

</Layout>

<!-- ========================= CSS ========================= -->
<style>
@tailwind base;
@tailwind components;
@tailwind utilities;

/* 新規追加：ズーム効果 */
@keyframes zoomInOut {
  0%, 10%   { transform: scale(1.1); }
  25%, 35%  { transform: scale(1.05); }
  50%, 60%  { transform: scale(1.1); }
  75%, 85%  { transform: scale(1.05); }
  100%      { transform: scale(1.1); }
}

/* Slide in right animation */
.letter-effect .slide-in-right {
  left: 60px;
  opacity: 0;
  transform: skewX(5deg);
  transition: opacity 1s ease-out, transform 1.5s, left 1.5s;
}

.letter-effect.open .slide-in-right {
  left: 0;
  opacity: 1;
  transform: skewX(0);
}

/* Story text animation */
.story-text {
  color: #fff;
  opacity: 0;
  transform: translateY(20px);
  transition: opacity 0.8s ease-out, transform 0.8s ease-out;
}

.story-text.animate {
  opacity: 1;
  transform: translateY(0);
}

#hero::before {
  content: "";
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  z-index: 1;
}
@keyframes fadeInOut {
  0% { opacity: 0; transform: translateY(20px); }
  100% { opacity: 1; transform: translateY(0); }
}

/* onscreen animation */
.ons_u {
  opacity: 0;
  transform: translateY(-70px);
  transition: all 1000ms cubic-bezier(0.19, 1, 0.22, 1);
}
.ons_u.onscreen {
  opacity: 1;
  transform: translateY(0);
}

/* underline animation */
.destinations_line {
  width: 680px;
  height: 1px;
  background: #ffff;
  margin: 20px auto;
  transform: scaleX(0);
  transform-origin: center;
  transition: transform 1000ms cubic-bezier(0.19, 1, 0.22, 1);
}
.destinations_line.onscreen {
  transform: scaleX(1);
}

/* transition delay helper */
[dly="500"].onscreen  { transition-delay: 500ms !important; }
[dly="600"].onscreen  { transition-delay: 600ms !important; }
[dly="700"].onscreen  { transition-delay: 700ms !important; }
[dly="800"].onscreen  { transition-delay: 800ms !important; }
[dly="1800"].onscreen { transition-delay: 1800ms !important; }

.cast-heading {
  font-size: 2rem;
  font-weight: bold;
  text-align: center;
  margin-top: 4rem;
  margin-bottom: 2rem;
  overflow: hidden;
}

.animated-text span {
  display: inline-block;
  opacity: 0;
  transform: translateY(1rem);
  transition: opacity 0.5s ease, transform 0.5s ease;
}

/* 青いスポットライト */
.spotlight {
  position: absolute;
  top: 0;
  left: 0;
  width: 1500px;
  height: 2000px;
 background: radial-gradient(
  ellipse at top left,
  rgba(100, 150, 255, 0.6) 0%,
  rgba(50, 100, 180, 0.25) 35%,
  rgba(0, 0, 40, 0) 100%
);

  filter: blur(100px);
  opacity: 0.6;
  animation: moveSpotlight 6s ease-in-out infinite alternate;
  mix-blend-mode: screen;
  z-index: 0;
}
@keyframes moveSpotlight {
  0% {
    transform: translate(0, 0);
  }
  100% {
    transform: translate(150px, 100px);
  }
}


/* 表示トリガー（onscreen）時にアニメーション */
.animated-text.onscreen span {
  opacity: 1;
  transform: translateY(0);
}

/* ラインが左から伸びる */
.line-grow {
  transition: width 0.8s ease 0.7s; /* 遅延させて文字が出てから伸びる */
}
.line-grow.onscreen {
  width: 100%;
}

/* Fade in text animation */
.fade-in-text {
  opacity: 0;
  transform: translateY(20px);
  transition: opacity 0.8s ease-out, transform 0.8s ease-out;
  transition-delay: var(--delay, 0s);
  display: inline-block;
}

.fade-in-text.visible {
  opacity: 1;
  transform: translateY(0);
}

.fa-location-dot {
  font-family: 'Font Awesome 6 Free';
  font-weight: 900;
  content: "\f3c5";
  display: inline-block;
}

.grayscale-cast {
  filter: grayscale(100%);
}

.hero {
  position: sticky;
  top: 0;
  width: 100%;
  height: 100vh;
  min-height: 100vh;
  overflow: hidden;
}

@media (max-width: 768px) {
  .hero {
    position: sticky;
    height: 100vh;
    min-height: 100vh;
  }
  #hero-slider {
    height: 85vh !important;
    min-height: 85vh !important;
  }
  .slide {
    height: 85vh !important;
    min-height: 85vh !important;
  }
  .slide img {
    object-fit: cover !important;
    object-position: top center !important;
    height: 100% !important;
    width: 100% !important;
  }
  .expo-heading {
    font-size: 1.25rem !important;
  }
  .expo-subheading {
    font-size: 0.75rem !important;
  }
  .expo-hero-text {
    left: 1.25rem !important;
    bottom: 1.25rem !important;
  }
  .video-fullscreen-mobile {
    width: 100vw;
    height: auto;
    max-width: 100vw;
    display: block;
    margin: 0 auto;
    object-fit: cover;
    background: #000;
  }
}

@media (max-width: 480px) {
  .hero {
    position: sticky;
    height: 85vh;
    min-height: 85vh;
  }
}

.hero-play-btn {
  position: fixed;
  bottom: 2rem;
  right: 2rem;
  z-index: 100;
  opacity: 0.7;
  transition: opacity 0.5s;
  background: none;
  border: none;
  width: 60px;
  height: 60px;
  padding: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
}

/* 画像のフェードアウト用スタイル */
#hero-image {
  opacity: 1;
  transition: opacity 2s ease-out;
}

#hero-image.fade-out {
  opacity: 0;
}

/* 動画のフェードイン用スタイル */
#hero-video {
  opacity: 0;
  transition: opacity 1.5s ease-in;
}

#hero-video.fade-in {
  opacity: 1;
}

/* スライダーのスタイル */
#hero-slider {
  position: relative;
  width: 100%;
  height: 100%;
  overflow: hidden;
  z-index: 0;
}

.slide {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  opacity: 0;
  z-index: 0;
  transition: opacity 3s ease;
}

.slide._active {
  opacity: 1;
  z-index: 1;
}

.slide img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transform: scale(1.1);
  transition: transform 7s linear;
}

.slide._active img {
  transform: scale(1);
}

/* サムネイルナビゲーション */
.thumb {
  position: absolute;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  gap: 10px;
  z-index: 100;
  list-style: none;
  padding: 0;
  margin: 0;
}

.thumb li {
  width: 12px;
  height: 12px;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.5);
  cursor: pointer;
  transition: opacity 0.2s ease-in-out;
}

.thumb li.active {
  background: white;
}

.thumb li:hover {
  opacity: 1;
}

/* Expo Text Styles */
.expo-heading {
  font-family: 'Montserrat', sans-serif;
  font-weight: 800;
  font-size: 3rem;
  color: white;
  letter-spacing: 0.6px;
  line-height: 1.2;
  text-align: left;
  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
}

.expo-subheading {
  font-family: 'Cormorant Garamond', serif;
  font-weight: 300;
  font-size: 1.5rem;
  color: white;
  letter-spacing: 0.5px;
  line-height: 1.3;
  text-align: left;
  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
}

.expo-subheading.font-serif {
  font-family: 'Noto Serif JP', serif;
}

/* Cast Animation Styles */
.cast-grid {
  opacity: 0;
}

.cast-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  opacity: 1;
  transform: none;
  transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
}

.cast-grid.visible {
  opacity: 1;
}

.cast-grid.visible .cast-item:nth-child(1) { transition-delay: 0.1s; }
.cast-grid.visible .cast-item:nth-child(2) { transition-delay: 0.3s; }
.cast-grid.visible .cast-item:nth-child(3) { transition-delay: 0.5s; }
.cast-grid.visible .cast-item:nth-child(4) { transition-delay: 0.7s; }
.cast-grid.visible .cast-item:nth-child(5) { transition-delay: 0.9s; }

.cast-grid.visible .cast-item {
  opacity: 1;
  transform: translateX(0);
}

/* View More Button Styles */
.view-more-btn {
  position: relative;
  overflow: hidden;
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 2px;
  background: rgba(255, 255, 255, 0.03);
  backdrop-filter: blur(8px);
  letter-spacing: 0.05em;
}

.view-more-btn::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(45deg, 
    rgba(255, 255, 255, 0.05) 0%,
    rgba(255, 255, 255, 0.02) 50%,
    rgba(255, 255, 255, 0.05) 100%
  );
  transform: translateX(-100%);
  transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);
}

.view-more-btn:hover::before {
  transform: translateX(100%);
}

.view-more-btn:hover {
  background: rgba(255, 255, 255, 0.05);
  border-color: rgba(255, 255, 255, 0.25);
  box-shadow: 0 0 20px rgba(255, 255, 255, 0.05);
}

.view-more-btn span {
  position: relative;
  display: inline-block;
  transition: transform 0.3s ease;
}

.view-more-btn:hover span {
  transform: translateX(2px);
}

.story-image.scrolled {
  transform: translate3d(-35.851px, 0, 0);
}

/* スライダーのスタイル調整 */
.your-slider {
  margin: 0 -10px;
  width: 100%;
  max-width: 600px;
}

.your-slider .slick-track {
  display: flex !important;
  flex-direction: row !important;
  align-items: center;
}

.your-slider .slick-slide {
  float: none !important;
  display: flex !important;
  height: auto !important;
  align-items: center;
  justify-content: center;
}

.your-slider img {
  transition: transform 0.3s ease;
}

.your-slider img:hover {
  transform: scale(1.05);
}

/* Add custom animation for horizontal scroll */
@layer utilities {
  @keyframes slide-track {
    0% { transform: translateX(0); }
    100% { transform: translateX(-50%); }
  }
  .animate-slide-track {
    animation: slide-track 30s linear infinite;
  }
}

/* Video Controls Styles */
.play-icon, .pause-icon {
  transition: transform 0.2s ease;
}

#play-pause-btn:hover .play-icon,
#play-pause-btn:hover .pause-icon {
  transform: scale(1.1);
}

#play-pause-btn:active .play-icon,
#play-pause-btn:active .pause-icon {
  transform: scale(0.95);
}

/* Safari対応のスタイル */
@supports (-webkit-touch-callout: none) {
  .hero {
    height: -webkit-fill-available;
    min-height: -webkit-fill-available;
  }
  
  #hero-slider {
    height: -webkit-fill-available;
    min-height: -webkit-fill-available;
  }
  
  .slide {
    height: -webkit-fill-available;
    min-height: -webkit-fill-available;
  }
}

/* iPhoneのホームインジケーター領域対応 */
@supports (padding: max(0px)) {
  .hero {
    padding-bottom: env(safe-area-inset-bottom);
  }
  
  #hero-slider {
    padding-bottom: env(safe-area-inset-bottom);
  }
  
  .slide {
    padding-bottom: env(safe-area-inset-bottom);
  }
}
</style>

<!-- ========================= JavaScript ========================= -->
<script>
  document.addEventListener("scroll", () => {
    const scrolled = window.scrollY;
    const hero = document.getElementById("hero");
    if (hero) {
      hero.style.backgroundPositionY = `${scrolled * 0.5}px`;
    }
  });

  document.addEventListener("DOMContentLoaded", () => {
  const observer = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      if (entry.isIntersecting) {
        entry.target.classList.add("onscreen");
        observer.unobserve(entry.target);
      }
    });
  }, { threshold: 0.3 });

  document.querySelectorAll(".ons_u, .destinations_line, .animated-text").forEach((el) => {
    observer.observe(el);
  });
});


  document.addEventListener("DOMContentLoaded", () => {
    const observer = new IntersectionObserver((entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.classList.add("onscreen");
          observer.unobserve(entry.target);
        }
      });
    }, { threshold: 0.3 });

    document.querySelectorAll(".ons_u, .destinations_line").forEach((el) => {
      observer.observe(el);
    });
  });
</script>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const header = document.querySelector('.header-navigation');
    let lastScrollY = window.scrollY;
    const scrollThreshold = 100; // スクロール量の閾値

    window.addEventListener('scroll', () => {
      const currentScrollY = window.scrollY;
      
      // スクロールが閾値を超えたらヘッダーを表示
      if (currentScrollY > scrollThreshold) {
        header?.classList.add('visible');
      } else {
        header?.classList.remove('visible');
      }
      
      lastScrollY = currentScrollY;
    });
  });
</script>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const observer = new IntersectionObserver((entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.classList.add('visible');
        } else {
          entry.target.classList.remove('visible');
        }
      });
    }, {
      threshold: 0.1,
      rootMargin: '0px 0px -50px 0px'
    });

    document.querySelectorAll('.fade-in-text').forEach((el) => {
      observer.observe(el);
    });
  });
</script>

<script>
  // Image preloading and optimization
  document.addEventListener('DOMContentLoaded', () => {
    // Preload next slide image
    function preloadNextImage(currentIndex: number): void {
      const slides = document.querySelectorAll('#hero-slider .slide');
      const nextIndex = (currentIndex + 1) % slides.length;
      const nextSlide = slides[nextIndex];
      const nextImages = nextSlide.querySelectorAll('img');
      
      nextImages.forEach(img => {
        if (img.dataset.src) {
          img.src = img.dataset.src;
          delete img.dataset.src;
        }
      });
    }

    // Initialize slider with optimized image loading
    const setId = '#hero-slider';
    const fadeTime = 3000;
    const delayTime = 6000;
    let setTimer: number | undefined;
    let currentIndex = 0;

    const slides = document.querySelectorAll(`${setId} .slide`);
    if (!slides || slides.length === 0) return;

    // Set initial state
    slides.forEach((slide, i) => {
      const slideElement = slide as HTMLElement;
      slideElement.id = `view${i + 1}`;
      slideElement.style.zIndex = '0';
      slideElement.style.opacity = '0';
    });

    const firstSlide = slides[0] as HTMLElement;
    if (firstSlide) {
      firstSlide.style.zIndex = '1';
      firstSlide.style.opacity = '1';
      firstSlide.classList.add('_active');
      
      // Preload next image immediately
      preloadNextImage(0);
    }

    function timer(): void {
      setTimer = window.setInterval(() => {
        const activeSlide = document.querySelector(`${setId} .slide._active`) as HTMLElement;
        if (!activeSlide) return;

        const slidesArr = Array.from(slides) as HTMLElement[];
        const currentIdx = slidesArr.indexOf(activeSlide);
        const nextIdx = (currentIdx + 1) % slidesArr.length;
        const nextSlide = slidesArr[nextIdx] as HTMLElement;

        // Start transition
        activeSlide.style.opacity = '0';
        setTimeout(() => {
          activeSlide.style.zIndex = '0';
          activeSlide.classList.remove('_active');
        }, fadeTime);

        nextSlide.style.zIndex = '1';
        setTimeout(() => {
          nextSlide.style.opacity = '1';
          nextSlide.classList.add('_active');
          
          // Preload next image after transition
          currentIndex = nextIdx;
          preloadNextImage(currentIndex);
        }, 50);
      }, delayTime);
    }

    timer();

    // Cleanup on page unload
    window.addEventListener('unload', () => {
      if (setTimer) {
        clearInterval(setTimer);
      }
    });
  });
</script>

<script>
  // Cast Animation
  document.addEventListener('DOMContentLoaded', () => {
    const castGrid = document.querySelector('.cast-grid');
    if (!castGrid) return;

    const observer = new IntersectionObserver((entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.classList.add('visible');
          observer.unobserve(entry.target);
        }
      });
    }, {
      threshold: 0.1,
      rootMargin: '0px 0px -50px 0px'
    });

    observer.observe(castGrid);
  });
</script>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    // ヘッダー・フッターのアンカーリンクを取得
    document.querySelectorAll('a[href^="#"]').forEach(link => {
      link.addEventListener('click', (event) => {
        const target = event.currentTarget as HTMLElement;
        const href = target.getAttribute('href');
        if (href && href.startsWith('#')) {
          const targetElement = document.querySelector(href);
          if (targetElement) {
            event.preventDefault();
            targetElement.scrollIntoView({ behavior: 'smooth' });
          }
        }
      });
    });
  });
</script>

<script>
  // STORYセクションのアニメーション
  document.addEventListener('DOMContentLoaded', () => {
    const storySection = document.getElementById('story');
    const introductionSection = document.getElementById('introduction');
    const cirqueSection = document.getElementById('cirque');
    
    // Handle underline animation for all three sections
    [storySection, introductionSection, cirqueSection].forEach(section => {
      if (!section) return;
      
      // Handle underline animation
      const underline = section.querySelector('.underline-animate');
      if (underline) {
        const observer = new IntersectionObserver((entries) => {
          entries.forEach((entry) => {
            const el = entry.target as HTMLElement;
            if (entry.isIntersecting) {
              el.style.transform = 'scaleX(1)';
            } else {
              el.style.transform = 'scaleX(0)';
            }
          });
        }, { threshold: 0.2 });
        observer.observe(underline);
      }

      // Handle slide-in-right animation for heading
      const letterEffect = section.querySelector('.letter-effect');
      if (letterEffect) {
        const observer = new IntersectionObserver((entries) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              letterEffect.classList.add('open');
            } else {
              letterEffect.classList.remove('open');
            }
          });
        }, { 
          threshold: 0.2,
          rootMargin: '-50px 0px'
        });
        observer.observe(letterEffect);
      }

      // Handle story text animations
      const storyTexts = section.querySelectorAll('.story-text');
      const storyTextContainer = section.querySelector('.story-text-container');
      
      // コンテナ全体を監視
      if (storyTextContainer) {
        const containerObserver = new IntersectionObserver((entries) => {
          entries.forEach((entry) => {
            if (!entry.isIntersecting) {
              // コンテナが画面外に出たら、すべてのテキストを非表示に
              storyTexts.forEach(text => {
                (text as HTMLElement).classList.remove('animate');
              });
            }
          });
        }, { 
          threshold: 0.1,
          rootMargin: '-100px 0px'
        });
        containerObserver.observe(storyTextContainer);
      }
      
      // 個別のテキスト要素のアニメーション
      storyTexts.forEach((text) => {
        const observer = new IntersectionObserver((entries) => {
          entries.forEach((entry) => {
            const textElement = text as HTMLElement;
            if (entry.isIntersecting) {
              const delay = parseFloat(text.getAttribute('data-delay') || '0') * 1000;
              setTimeout(() => {
                textElement.classList.add('animate');
              }, delay);
            }
          });
        }, { 
          threshold: 0.5,
          rootMargin: '-100px 0px'
        });
        observer.observe(text);
      });
    });
  });
</script>

<!-- jQueryとSlickのJSを読み込む -->
<script is:inline src="/slick/jquery.min.js"></script>
<script is:inline src="/slick/slick.min.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    $('.your-slider').slick({
      dots: false,
      infinite: true,
      speed: 3000,
      slidesToShow: 3,
      slidesToScroll: 1,
      autoplay: true,
      autoplaySpeed: 0,
      cssEase: 'linear',
      arrows: false,
      pauseOnHover: false,
      responsive: [
        {
          breakpoint: 1024,
          settings: {
            slidesToShow: 2,
          }
        },
        {
          breakpoint: 600,
          settings: {
            slidesToShow: 1,
          }
        }
      ]
    });
  });
</script>

<script is:inline>
  window.sliderImages = JSON.parse(`${JSON.stringify(sliderImages)}`);
  document.addEventListener('DOMContentLoaded', function() {
    const images = window.sliderImages;
    let idx = 0;
    const imgEl = document.getElementById('simple-slider-img');
    setInterval(() => {
      idx = (idx + 1) % images.length;
      imgEl.src = images[idx];
    }, 3000);
  });
</script>

<script>
  // Video Controls
  document.addEventListener('DOMContentLoaded', () => {
    const video = document.getElementById('behind-scenes-video') as HTMLVideoElement;
    const videoPoster = document.getElementById('video-poster');
    const playPauseBtn = document.getElementById('play-pause-btn');
    const playIcon = playPauseBtn?.querySelector('.play-icon');
    const pauseIcon = playPauseBtn?.querySelector('.pause-icon');
    const progressBar = document.getElementById('video-progress');
    const videoContainer = video?.parentElement;

    if (!video || !playPauseBtn || !playIcon || !pauseIcon || !videoPoster || !progressBar || !videoContainer) return;

    // プログレスバーの更新
    video.addEventListener('timeupdate', () => {
      const progress = (video.currentTime / video.duration) * 100;
      progressBar.style.width = `${progress}%`;
    });

    // プログレスバーのクリック/タップでシーク
    const progressBarContainer = progressBar.parentElement;
    if (progressBarContainer) {
      progressBarContainer.addEventListener('click', (e) => {
        const rect = progressBarContainer.getBoundingClientRect();
        const pos = (e.clientX - rect.left) / rect.width;
        video.currentTime = pos * video.duration;
      });

      // タッチデバイス用のイベント
      progressBarContainer.addEventListener('touchstart', (e) => {
        e.preventDefault();
        const touch = e.touches[0];
        const rect = progressBarContainer.getBoundingClientRect();
        const pos = (touch.clientX - rect.left) / rect.width;
        video.currentTime = pos * video.duration;
      });
    }

    // 再生/一時停止ボタン
    playPauseBtn.addEventListener('click', () => {
      if (video.paused) {
        videoPoster.style.display = 'none';
        video.classList.remove('hidden');
        video.muted = false; // 音声を有効化
        video.play();
        playIcon.classList.add('hidden');
        pauseIcon.classList.remove('hidden');
      } else {
        video.pause();
        playIcon.classList.remove('hidden');
        pauseIcon.classList.add('hidden');
      }
    });

    // フルスクリーンボタン
    const fullscreenBtn = document.getElementById('fullscreen-btn');
    if (fullscreenBtn) {
      fullscreenBtn.addEventListener('click', () => {
        if (document.fullscreenElement) {
          document.exitFullscreen();
        } else {
          videoContainer.requestFullscreen();
        }
      });
    }

    // 動画が終了したら
    video.addEventListener('ended', () => {
      playIcon.classList.remove('hidden');
      pauseIcon.classList.add('hidden');
      video.currentTime = 0;
    });

    // キーボードショートカット
    document.addEventListener('keydown', (e) => {
      if (e.code === 'Space') {
        e.preventDefault();
        playPauseBtn.click();
      }
    });
  });
</script>